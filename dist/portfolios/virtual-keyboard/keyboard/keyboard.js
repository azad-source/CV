const engKeys=[["1","2","3","4","5","6","7","8","9","0","-","=","backspace"],["caps","q","w","e","r","t","y","u","i","o","p","[","]"],["shift","a","s","d","f","g","h","j","k","l",";","'","enter"],["done","z","x","c","v","b","n","m",",",".","/"],["en","sound","space","left","right"]];let defaultKeys=engKeys;const shiftEngKeys=[["!","@","#","$","%","^","&","*","(",")","_","+","backspace"],["caps","q","w","e","r","t","y","u","i","o","p","{","}"],["shift","a","s","d","f","g","h","j","k","l",":",'"',"enter"],["done","z","x","c","v","b","n","m","<",">","?"],["en","sound","space","left","right"]];let shiftDefaultKeys=shiftEngKeys;const rusKeys=[["1","2","3","4","5","6","7","8","9","0","-","=","backspace"],["caps","й","ц","у","к","е","н","г","ш","щ","з","х","ъ"],["shift","ф","ы","в","а","п","р","о","л","д","ж","э","enter"],["done","я","ч","с","м","и","т","ь","б","ю","."],["ru","sound","space","left","right"]],shiftRusKeys=[["!",'"',"№",";","%",":","?","*","(",")","_","+","backspace"],["caps","й","ц","у","к","е","н","г","ш","щ","з","х","ъ"],["shift","ф","ы","в","а","п","р","о","л","д","ж","э","enter"],["done","я","ч","с","м","и","т","ь","б","ю",","],["ru","sound","space","left","right"]],properties={value:"",capsLock:!1,shift:!1,cursorPos:0,ru:!1,sound:!1},render=(e,r)=>e.appendChild(r),createElement=e=>{const r=document.createElement(e.type);return r.type=e.type||"",r.className=e.class||"",void 0!==e.innerHTML&&(r.innerHTML=e.innerHTML),void 0!==e.textContent&&(r.textContent=e.textContent),void 0!==e.value&&(r.value=e.value),r},updateTextArea=()=>{const e=document.querySelector(".use-keyboard-input");e.focus(),e.value=properties.value},setCaretPosition=e=>{const r=document.querySelector(".use-keyboard-input");null===r&&void 0===r||(r.focus(),r.setSelectionRange(e,e))},backspace=()=>{properties.cursorPos===properties.value.length?(properties.value=properties.value.slice(0,-1),properties.cursorPos=properties.value.length):0!==properties.cursorPos&&(properties.value=properties.value.slice(0,properties.cursorPos-1)+properties.value.slice(properties.cursorPos),properties.cursorPos=properties.cursorPos-1),updateTextArea(),setCaretPosition(properties.cursorPos)},caps=()=>{keysContainerElement.innerHTML="",properties.capsLock?(properties.capsLock=!1,properties.shift?render(keysContainerElement,keys({keys:shiftDefaultKeys})):render(keysContainerElement,keys({keys:defaultKeys}))):(properties.capsLock=!0,properties.shift?render(keysContainerElement,keys({keys:shiftDefaultKeys})):render(keysContainerElement,keys({keys:defaultKeys})))},shift=()=>{keysContainerElement.innerHTML="",properties.shift?(properties.shift=!1,render(keysContainerElement,keys({keys:defaultKeys}))):(properties.shift=!0,render(keysContainerElement,keys({keys:shiftDefaultKeys})))},sound=e=>{if(!properties.sound)return;let r;r="CapsLock"===e?document.querySelector('audio[data-key="caps-key"]'):"Shift"===e?document.querySelector('audio[data-key="shift-key"]'):" "===e?document.querySelector('audio[data-key="space-key"]'):"Enter"===e?document.querySelector('audio[data-key="enter-key"]'):"Backspace"===e?document.querySelector('audio[data-key="backspace-key"]'):properties.ru?document.querySelector('audio[data-key="rus-key"]'):document.querySelector('audio[data-key="eng-key"]'),r.currentTime=0,r.play()};let keyElements;const keys=e=>{const r=document.createDocumentFragment(),t=e=>`<i class="material-icons">${e}</i>`;return e.keys.forEach((e=>{e.forEach((e=>{switch(e){case"backspace":{const e=createElement({type:"button",class:"keyboard__key keyboard__key--wide",innerHTML:t("backspace")});e.addEventListener("click",(()=>{sound("Backspace"),properties.cursorPos===properties.value.length?(properties.value=properties.value.slice(0,-1),properties.cursorPos=properties.value.length):0!==properties.cursorPos&&(properties.value=properties.value.slice(0,properties.cursorPos-1)+properties.value.slice(properties.cursorPos),properties.cursorPos=properties.cursorPos-1),updateTextArea(),setCaretPosition(properties.cursorPos)})),render(r,e);break}case"caps":{const e=properties.capsLock?" keyboard__key--active":"",s=createElement({type:"button",class:"keyboard__key keyboard__key--wide keyboard__key--activatable"+e,innerHTML:t("keyboard_capslock")});s.addEventListener("click",(()=>{sound("CapsLock"),caps()})),render(r,s);break}case"shift":{const e=properties.shift?" keyboard__key--active":"",s=createElement({type:"button",class:"keyboard__key keyboard__key--wide keyboard__key--activatable"+e,innerHTML:t("keyboard_arrow_up")});s.addEventListener("click",(()=>{sound("Shift"),shift(),keyElements=[...document.querySelectorAll(".keyboard__key")].reduce(((e,r)=>(void 0===e[r]&&(1===r.children.length?e[r.children[0].innerHTML.toLowerCase()]=r:e[r.innerHTML.toLowerCase()]=r),e)),{}),keyElements.check_circle.addEventListener("click",(()=>{keyElements.check_circle.classList.add("keyboard__key-active"),setTimeout((()=>keyElements.check_circle.classList.remove("keyboard__key-active")),150),keyboardElement.classList.add("keyboard--hidden")}))})),render(r,s);break}case"enter":{const e=createElement({type:"button",class:"keyboard__key keyboard__key--wide",innerHTML:t("keyboard_return")});e.addEventListener("click",(()=>{sound("Enter"),properties.value+="\n",properties.cursorPos+=1,updateTextArea(),setCaretPosition(properties.cursorPos)})),render(r,e);break}case"en":{const t=createElement({type:"button",class:"keyboard__key",innerHTML:e});t.addEventListener("click",(()=>{sound(""),properties.ru=!0,keysContainerElement.innerHTML="",defaultKeys=rusKeys,shiftDefaultKeys=shiftRusKeys,render(keysContainerElement,keys({keys:defaultKeys})),keyElements=[...document.querySelectorAll(".keyboard__key")].reduce(((e,r)=>(void 0===e[r]&&(1===r.children.length?e[r.children[0].innerHTML.toLowerCase()]=r:e[r.innerHTML.toLowerCase()]=r),e)),{}),keyElements.check_circle.addEventListener("click",(()=>{keyElements.check_circle.classList.add("keyboard__key-active"),setTimeout((()=>keyElements.check_circle.classList.remove("keyboard__key-active")),150),keyboardElement.classList.add("keyboard--hidden")}))})),render(r,t);break}case"ru":{const t=createElement({type:"button",class:"keyboard__key",innerHTML:e});t.addEventListener("click",(()=>{sound(""),properties.ru=!1,keysContainerElement.innerHTML="",defaultKeys=engKeys,shiftDefaultKeys=shiftEngKeys,render(keysContainerElement,keys({keys:defaultKeys})),keyElements=[...document.querySelectorAll(".keyboard__key")].reduce(((e,r)=>(void 0===e[r]&&(1===r.children.length?e[r.children[0].innerHTML.toLowerCase()]=r:e[r.innerHTML.toLowerCase()]=r),e)),{}),keyElements.check_circle.addEventListener("click",(()=>{keyElements.check_circle.classList.add("keyboard__key-active"),setTimeout((()=>keyElements.check_circle.classList.remove("keyboard__key-active")),150),keyboardElement.classList.add("keyboard--hidden")}))})),render(r,t);break}case"space":{const e=createElement({type:"button",class:"keyboard__key keyboard__key--wide",innerHTML:t("space_bar")});e.addEventListener("click",(()=>{sound(" "),properties.value=properties.value.slice(0,properties.cursorPos)+" "+properties.value.slice(properties.cursorPos),updateTextArea(),properties.cursorPos+=1,setCaretPosition(properties.cursorPos)})),render(r,e);break}case"left":{const e=createElement({type:"button",class:"keyboard__key keyboard__key--wide",innerHTML:t("keyboard_arrow_left")});e.addEventListener("click",(()=>{sound(""),0!==properties.cursorPos&&(properties.cursorPos=properties.cursorPos-1),setCaretPosition(properties.cursorPos)})),render(r,e);break}case"right":{const e=createElement({type:"button",class:"keyboard__key keyboard__key--wide",innerHTML:t("keyboard_arrow_right")});e.addEventListener("click",(()=>{sound(""),properties.cursorPos!==properties.value.length&&(properties.cursorPos=properties.cursorPos+1),setCaretPosition(properties.cursorPos)})),render(r,e);break}case"sound":{const e=properties.sound?" keyboard__key--active":"",s=createElement({type:"button",class:"keyboard__key keyboard__key--wide keyboard__key--activatable"+e,innerHTML:t("audiotrack")});s.addEventListener("click",(()=>{properties.sound?(s.classList.remove("keyboard__key--active"),properties.sound=!1):(s.classList.add("keyboard__key--active"),properties.sound=!0)})),render(r,s);break}case"done":{const e=createElement({type:"button",class:"keyboard__key keyboard__key--wide keyboard__key--dark",innerHTML:t("check_circle")});render(r,e);break}default:{let t;t=!!(properties.capsLock&&!properties.shift||properties.shift&&!properties.capsLock);const s=createElement({type:"button",class:"keyboard__key",textContent:t?e.toUpperCase():e.toLowerCase()});s.addEventListener("click",(()=>{sound(""),properties.value=properties.value.slice(0,properties.cursorPos)+s.textContent+properties.value.slice(properties.cursorPos),updateTextArea(),properties.cursorPos+=1,setCaretPosition(properties.cursorPos)})),render(r,s);break}}})),render(r,document.createElement("br"))})),r},keyboardElement=createElement({type:"div",class:"keyboard"});keyboardElement.classList.add("keyboard--hidden");const keysContainerElement=createElement({type:"div",class:"keyboard__keys"}),textArea=document.querySelector(".use-keyboard-input");render(keyboardElement,keysContainerElement),render(keysContainerElement,keys({keys:engKeys})),render(document.body,keyboardElement),keyElements=[...document.querySelectorAll(".keyboard__key")].reduce(((e,r)=>(void 0===e[r]&&(1===r.children.length?e[r.children[0].innerHTML.toLowerCase()]=r:e[r.innerHTML.toLowerCase()]=r),e)),{}),keyElements.check_circle.addEventListener("click",(()=>{keyElements.check_circle.classList.add("keyboard__key-active"),setTimeout((()=>keyElements.check_circle.classList.remove("keyboard__key-active")),150),keyboardElement.classList.add("keyboard--hidden")}));let blockout=!1,isShiftPress=!1;document.body.addEventListener("keydown",(e=>(keyboardElement.classList.remove("keyboard--hidden"),e.shiftKey&&e.altKey?(blockout=!0,properties.ru?(defaultKeys=engKeys,shiftDefaultKeys=shiftEngKeys,properties.ru=!1):(defaultKeys=rusKeys,shiftDefaultKeys=shiftRusKeys,properties.ru=!0),keysContainerElement.innerHTML="",render(keysContainerElement,keys({keys:defaultKeys})),keyElements=[...document.querySelectorAll(".keyboard__key")].reduce(((e,r)=>(void 0===e[r]&&(1===r.children.length?e[r.children[0].innerHTML.toLowerCase()]=r:e[r.innerHTML.toLowerCase()]=r),e)),{}),setTimeout((()=>blockout=!1),500),void keyElements.check_circle.addEventListener("click",(()=>{keyElements.check_circle.classList.add("keyboard__key-active"),setTimeout((()=>keyElements.check_circle.classList.remove("keyboard__key-active")),150),keyboardElement.classList.add("keyboard--hidden")}))):"Shift"===e.key?(shift(),keyElements=[...document.querySelectorAll(".keyboard__key")].reduce(((e,r)=>(void 0===e[r]&&(1===r.children.length?e[r.children[0].innerHTML.toLowerCase()]=r:e[r.innerHTML.toLowerCase()]=r),e)),{}),keyElements.keyboard_arrow_up.classList.add("keyboard__key-active"),setTimeout((()=>keyElements.keyboard_arrow_up.classList.remove("keyboard__key-active")),150),void keyElements.check_circle.addEventListener("click",(()=>{keyElements.check_circle.classList.add("keyboard__key-active"),setTimeout((()=>keyElements.check_circle.classList.remove("keyboard__key-active")),150),keyboardElement.classList.add("keyboard--hidden")}))):void(shiftDefaultKeys.some((r=>r.includes(e.key.toLowerCase())))&&("&"===e.key&&void 0!==keyElements["&amp;"]?keyElements["&amp;"].classList.add("keyboard__key-active"):void 0!==keyElements[e.key.toLowerCase()]&&keyElements[e.key.toLowerCase()].classList.add("keyboard__key-active"),textArea.focus(),properties.cursorPos=textArea.selectionStart,properties.value=textArea.value,setTimeout((()=>{"&"===e.key?keyElements["&amp;"].classList.remove("keyboard__key-active"):keyElements[e.key.toLowerCase()].classList.remove("keyboard__key-active")}),150)))))),document.body.addEventListener("keyup",(e=>{if(keyboardElement.classList.remove("keyboard--hidden"),sound(e.key),!blockout){if("CapsLock"===e.key)return caps(),keyElements=[...document.querySelectorAll(".keyboard__key")].reduce(((e,r)=>(void 0===e[r]&&(1===r.children.length?e[r.children[0].innerHTML.toLowerCase()]=r:e[r.innerHTML.toLowerCase()]=r),e)),{}),keyElements.keyboard_capslock.classList.add("keyboard__key-active"),setTimeout((()=>keyElements.keyboard_capslock.classList.remove("keyboard__key-active")),150),void keyElements.check_circle.addEventListener("click",(()=>{keyElements.check_circle.classList.add("keyboard__key-active"),setTimeout((()=>keyElements.check_circle.classList.remove("keyboard__key-active")),150),keyboardElement.classList.add("keyboard--hidden")}));if("Shift"===e.key)return keyElements=[...document.querySelectorAll(".keyboard__key")].reduce(((e,r)=>(void 0===e[r]&&(1===r.children.length?e[r.children[0].innerHTML.toLowerCase()]=r:e[r.innerHTML.toLowerCase()]=r),e)),{}),keyElements.keyboard_arrow_up.classList.add("keyboard__key-active"),setTimeout((()=>keyElements.keyboard_arrow_up.classList.remove("keyboard__key-active")),150),void keyElements.check_circle.addEventListener("click",(()=>{keyElements.check_circle.classList.add("keyboard__key-active"),setTimeout((()=>keyElements.check_circle.classList.remove("keyboard__key-active")),150),keyboardElement.classList.add("keyboard--hidden")}));if("Backspace"===e.key||"Enter"===e.key||" "===e.key)return"Enter"===e.key?(keyElements.keyboard_return.classList.add("keyboard__key-active"),setTimeout((()=>keyElements.keyboard_return.classList.remove("keyboard__key-active")),150)):" "===e.key?(keyElements.space_bar.classList.add("keyboard__key-active"),setTimeout((()=>keyElements.space_bar.classList.remove("keyboard__key-active")),150)):(keyElements[e.key.toLowerCase()].classList.add("keyboard__key-active"),setTimeout((()=>keyElements[e.key.toLowerCase()].classList.remove("keyboard__key-active")),150)),textArea.focus(),properties.cursorPos=textArea.selectionStart,void(properties.value=textArea.value);defaultKeys.some((r=>r.includes(e.key.toLowerCase())))&&("&"===e.key&&void 0!==keyElements["&amp;"]?keyElements["&amp;"].classList.add("keyboard__key-active"):void 0!==keyElements[e.key.toLowerCase()]&&keyElements[e.key.toLowerCase()].classList.add("keyboard__key-active"),textArea.focus(),properties.cursorPos=textArea.selectionStart,properties.value=textArea.value,setTimeout((()=>{"&"===e.key?keyElements["&amp;"].classList.remove("keyboard__key-active"):keyElements[e.key.toLowerCase()].classList.remove("keyboard__key-active")}),150)),shiftDefaultKeys.some((r=>r.includes(e.key.toLowerCase())))&&(textArea.focus(),properties.cursorPos=textArea.selectionStart,properties.value=textArea.value)}})),textArea.addEventListener("click",(e=>{keyboardElement.classList.remove("keyboard--hidden"),properties.cursorPos=e.target.selectionStart})),textArea.addEventListener("keyup",(e=>(keyboardElement.classList.remove("keyboard--hidden"),"ArrowLeft"===e.key?(keyElements.keyboard_arrow_left.classList.add("keyboard__key-active"),setTimeout((()=>keyElements.keyboard_arrow_left.classList.remove("keyboard__key-active")),150),void(properties.cursorPos=e.target.selectionStart)):"ArrowRight"===e.key?(keyElements.keyboard_arrow_right.classList.add("keyboard__key-active"),setTimeout((()=>keyElements.keyboard_arrow_right.classList.remove("keyboard__key-active")),150),void(properties.cursorPos=e.target.selectionStart)):void 0)));