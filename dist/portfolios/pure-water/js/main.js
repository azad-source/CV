var mobileWith=420;Inputmask({mask:"+7 (999) 999-99-99"}).mask("[name='customer_phone']");var minInputLenth=3,maxBottleCount=999,timeArr={weekdays:["10:00 - 11:00","12:00 - 13:00","15:00 - 16:00"],weekend:["12:00 - 13:00","15:00 - 16:00"]},promo_block=[".left_block"],order_contact_info=[".right_block",".order_title",".order_title h2",".order_contact_info",".open_order_detail"],order_detail=[".right_block",".order_title",".prev_page",".order_detail",".total_price",".order_submit"],order_resume=[".right_block",".order_title",".order_title h2",".order_success",".order_resume",".total_price",".order_info",".new_order"],all_elms=[];all_elms=all_elms.concat(all_elms,order_contact_info,order_detail,order_resume,promo_block),all_elms=[...new Set(all_elms)];var weekday=["вс","пн","вт","ср","чт","пт","сб"],month=["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],orderData={};function validForm(e){var t,r,a,n,l,i=elmByName("customer_name")[0],o=elmByName("customer_mail")[0],u=elmByName("customer_phone")[0],m=elmByName("customer_address")[0],c=elmByName("customer_privacy")[0];return t="undefined"!=i.value&&""!=i.value&&i.value.length>=minInputLenth,r=!!validateEmail(o.value),a=!u.value.includes("_")&&u.value.length>1,n="undefined"!=m.value&&m.value.length>=minInputLenth,l=!!c.checked,t&&r&&a&&n&&l?(open_order_detail.disabled=!1,order_submit.disabled=!1):(open_order_detail.disabled=!0,order_submit.disabled=!0),t&&r&&a&&n&&l}function validateEmail(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())}function getBrowsSize(){return{width:window.innerWidth||document.body.clientWidth,height:window.innerHeight||document.body.clientHeight}}function getOrderData(){orderData={name:elmByQuery('[name="customer_name"]').value,email:elmByQuery('[name="customer_mail"]').value,phone:elmByQuery('[name="customer_phone"]').value,address:elmByQuery('[name="customer_address"]').value,privPolicy:elmByName("customer_privacy")[0].checked,bottleVariant:elmByQuery(".volume_variant_active .volume_value").innerText,bottleCount:elmByQuery('.volume_variant_active [name="count_field"]').value,dateDelivery:new Date(elmByQuery(".delivery_day .active_slide .delivery_date").value),timeDelivery:elmByQuery(".delivery_time .active_time").innerText,totalPrice:elmByQuery(".total_price_value .int_value").innerText}}function setDelivInterval(e){let t;t="сб"==elmByQuery(".active_slide .week_value").innerText||"вс"==elmByQuery(".active_slide .week_value").innerText?e.weekend:e.weekdays;var r=document.createElement("div");r.classList.add("delivery_time_list");for(var a=0;a<t.length;a++){var n=document.createElement("div");n.classList.add("delivery_time_item"),0==a&&n.classList.add("active_time"),n.innerText=t[a],r.append(n)}elmByQuery(".delivery_time_list").replaceWith(r)}function clearAllUserFields(){elmByQuery('[name="customer_name"]').value="",elmByQuery('[name="customer_mail"]').value="",elmByQuery('[name="customer_phone"]').value="",elmByQuery('[name="customer_address"]').value="",elmByName("customer_privacy")[0].checked=!0}function elemHide(e){size=getBrowsSize(),e.forEach((function(e){".left_block"==e&&size.width>mobileWith||(elmByQuery(e).style.display="none")}))}function showBlock(e){e.forEach((function(e){elmByQuery(e).style.display="flex"}))}function setInner(e,t){elmByQuery(e).innerText=t}function elmByQuery(e){return document.querySelector(e)}function elmByQueryAll(e){return document.querySelectorAll(e)}function elmByClass(e){return document.getElementsByClassName(e)}function elmById(e){return document.getElementById(e)}function elmByName(e){return document.getElementsByName(e)}function randomInteger(e,t){let r=e-.5+Math.random()*(t-e+1);return Math.round(r)}!function(){open_order_form.onclick=function(){setInner(".order_title h2","Заполните данные"),elemHide(all_elms),showBlock(order_contact_info)},open_order_detail.onclick=function(){validForm()&&(elemHide(all_elms),showBlock(order_detail))},prev_page.onclick=function(){elemHide(all_elms),showBlock(order_contact_info)},order_submit.onclick=function(){getOrderData();var e=orderData,t=new XMLHttpRequest;t.onreadystatechange=function(){4===t.readyState&&validForm()&&(200===t.status?(setInner(".order_title h2","Заказ оформлен"),size=getBrowsSize(),size.width>mobileWith?(elemHide(order_contact_info),elemHide(order_detail)):elemHide(all_elms),showBlock(order_resume),elmByQuery(".resume_bottle_variant").innerText="Бутыль "+orderData.bottleVariant,elmByQuery(".resume_bottle_count").innerText=orderData.bottleCount+" шт",elmByQuery(".resume_date").innerText=orderData.dateDelivery.getDate()+" "+month[orderData.dateDelivery.getMonth()],elmByQuery(".resume_time").innerText=orderData.timeDelivery,elmByQuery(".resume_address_value").innerText=orderData.address,elmByQuery(".resume_phone_value").innerText=orderData.phone,elmByQuery(".order_num").innerText="№"+randomInteger(100,999)):(alert("Во время оформления заказа произошла ошибка. попробуйте повторить заказ чуть позже"),console.log("An error occurred during your request: "+t.status+" "+t.statusText)))};var r=JSON.stringify(e);t.open("POST","/sendmail.php",!0),t.setRequestHeader("Content-type","application/json"),t.send(r)},new_order.onclick=function(){document.location.reload(!0)},elmByName("customer_name")[0].oninput=function(e){validForm(e)},elmByName("customer_mail")[0].oninput=function(e){validForm(e)},elmByName("customer_phone")[0].oninput=function(e){validForm(e)},elmByName("customer_address")[0].oninput=function(e){validForm(e)},elmByName("customer_privacy")[0].oninput=function(e){validForm(e)},document.addEventListener("click",(function(e){if(e.target.matches(".bottle_params, .bottle_params *")){e.preventDefault();var r=e.target.closest(".volume_variant"),a=elmByClass("volume_variant");[].forEach.call(a,(function(e){e.classList.contains("volume_variant_active")&&(e.classList.remove("volume_variant_active"),e.querySelector(".bottle_count").style.display="none")})),r.classList.toggle("volume_variant_active"),r.querySelector(".bottle_count").style.display="flex",t(),getOrderData()}}),!1);var e=function(e,r,a){if(e.target.matches(".bottle_count_btn"+r)){e.preventDefault();var n=e.target.closest(".bottle_count").querySelector('[name="count_field"]'),l=parseInt(n.value);a>0&&l<maxBottleCount&&(n.value=l+a),a<0&&l>1&&(n.value=l+a),t(),getOrderData()}};function t(){var e=elmByQuery(".volume_variant.volume_variant_active"),t=parseInt(e.querySelector(".price").innerText),r=parseInt(e.querySelector('.bottle_count [name="count_field"]').value)*t;elmByQuery(".total_price_value .int_value").innerText=r}document.addEventListener("click",(function(t){e(t,".plus",1)}),!1),document.addEventListener("click",(function(t){e(t,".minus",-1)}),!1),document.addEventListener("click",(function(e){if(e.target.matches(".tiny-slide, .tiny-slide *")){e.preventDefault();var t=e.target.closest(".tiny-slide"),r=elmByClass("tiny-slide");[].forEach.call(r,(function(e){e.classList.contains("active_slide")&&e.classList.remove("active_slide")})),t.classList.toggle("active_slide"),setDelivInterval(timeArr),getOrderData()}}),!1),document.addEventListener("click",(function(e){if(e.target.matches(".delivery_time_item, .delivery_time_item *")){e.preventDefault();var t=e.target,r=elmByClass("delivery_time_item");[].forEach.call(r,(function(e){e.classList.contains("active_time")&&e.classList.remove("active_time")})),t.classList.toggle("active_time"),getOrderData()}}),!1),Date.prototype.addDays=function(e){var t=new Date(this.valueOf());return t.setDate(t.getDate()+e),t},n=new Date;for(var r=elmByQueryAll(".tiny-slide"),a=0;a<r.length;a++)0!=a&&(n=n.addDays(1)),input=document.createElement("INPUT"),input.setAttribute("type","hidden"),input.setAttribute("class","delivery_date"),input.setAttribute("value",n),r[a].append(input),day=n.getDate(),wday=n.getDay(),r[a].querySelector(".day_value").innerHTML=day,r[a].querySelector(".week_value").innerHTML=weekday[wday],0==wday||6==wday?r[a].querySelector(".week_value").style.color="#FD7562":r[a].querySelector(".week_value").style.color="#9CAEDD";tns({container:".slider-wrapper",items:7,speed:1e3,loop:!0,controlsContainer:"#customize-controls",autoplayButtonOutput:!1,nav:!1,slideBy:"page",mouseDrag:!0,lazyload:!0,responsive:{420:{items:6}}});setDelivInterval(timeArr),t(),getOrderData()}();